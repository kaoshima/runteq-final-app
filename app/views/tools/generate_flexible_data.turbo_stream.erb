<%= turbo_stream.update "flexible-results" do %>
  <% if @error %>
    <div class="error-message">
      <svg xmlns="http://www.w3.org/2000/svg" class="error-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
      </svg>
      <%= @error %>
    </div>
  <% elsif @generated_data.present? %>
    <div class="result-section">
      <div class="result-header">
        <h3 class="result-title">生成結果（<%= @generated_data.length %>件）</h3>
        <button type="button" class="btn btn-copy" onclick="copyAllFlexibleData()">
          すべてコピー
        </button>
      </div>

      <div class="result-list">
        <% @generated_data.each_with_index do |data, index| %>
          <div class="result-list-item">
            <span class="result-list-number"><%= index + 1 %>.</span>
            <span class="result-list-text" data-text="<%= data %>"><%= data %></span>
            <button type="button" class="btn-icon" onclick="copySingleData(this)" title="コピー">
              <svg xmlns="http://www.w3.org/2000/svg" class="icon" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
              </svg>
            </button>
          </div>
        <% end %>
      </div>

      <div class="result-textarea-container">
        <label class="form-label">すべてのデータ（改行区切り）</label>
        <textarea id="all-data-textarea" class="result-textarea" readonly><%= @generated_data.join("\n") %></textarea>
      </div>
    </div>
  <% end %>
<% end %>
